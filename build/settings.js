(()=>{"use strict";const e=window.wp.i18n,n=window.wp.plugins,t=window.wp.editor,l=window.wp.primitives,i=window.ReactJSXRuntime,a=(0,i.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(l.Path,{d:"M12 3.3c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8s-4-8.8-8.8-8.8zm6.5 5.5h-2.6C15.4 7.3 14.8 6 14 5c2 .6 3.6 2 4.5 3.8zm.7 3.2c0 .6-.1 1.2-.2 1.8h-2.9c.1-.6.1-1.2.1-1.8s-.1-1.2-.1-1.8H19c.2.6.2 1.2.2 1.8zM12 18.7c-1-.7-1.8-1.9-2.3-3.5h4.6c-.5 1.6-1.3 2.9-2.3 3.5zm-2.6-4.9c-.1-.6-.1-1.1-.1-1.8 0-.6.1-1.2.1-1.8h5.2c.1.6.1 1.1.1 1.8s-.1 1.2-.1 1.8H9.4zM4.8 12c0-.6.1-1.2.2-1.8h2.9c-.1.6-.1 1.2-.1 1.8 0 .6.1 1.2.1 1.8H5c-.2-.6-.2-1.2-.2-1.8zM12 5.3c1 .7 1.8 1.9 2.3 3.5H9.7c.5-1.6 1.3-2.9 2.3-3.5zM10 5c-.8 1-1.4 2.3-1.8 3.8H5.5C6.4 7 8 5.6 10 5zM5.5 15.3h2.6c.4 1.5 1 2.8 1.8 3.7-1.8-.6-3.5-2-4.4-3.7zM14 19c.8-1 1.4-2.2 1.8-3.7h2.6C17.6 17 16 18.4 14 19z"})}),o=(0,i.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(l.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M5 4.5h11a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-.5.5H5a.5.5 0 0 1-.5-.5V5a.5.5 0 0 1 .5-.5ZM3 5a2 2 0 0 1 2-2h11a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5Zm17 3v10.75c0 .69-.56 1.25-1.25 1.25H6v1.5h12.75a2.75 2.75 0 0 0 2.75-2.75V8H20Z"})}),s=(0,i.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(l.Path,{d:"M18 11.3l-1-1.1-4 4V3h-1.5v11.3L7 10.2l-1 1.1 6.2 5.8 5.8-5.8zm.5 3.7v3.5h-13V15H4v5h16v-5h-1.5z"})}),r=window.wp.data,d=window.wp.notices,c=window.wp.compose,u=window.wp.blob,p=window.wp.components,m=window.wp.element,f={sort:function(e,n,t){return"asc"===t?e-n:n-e},isValid:function(e,n){if(""===e)return!1;if(!Number.isInteger(Number(e)))return!1;if(n?.elements){const t=n?.elements.map((e=>e.value));if(!t.includes(Number(e)))return!1}return!0},Edit:"integer"},g={sort:function(e,n,t){return"asc"===t?e.localeCompare(n):n.localeCompare(e)},isValid:function(e,n){if(n?.elements){const t=n?.elements?.map((e=>e.value));if(!t.includes(e))return!1}return!0},Edit:"text"},h={sort:function(e,n,t){const l=new Date(e).getTime(),i=new Date(n).getTime();return"asc"===t?l-i:i-l},isValid:function(e,n){if(n?.elements){const t=n?.elements.map((e=>e.value));if(!t.includes(e))return!1}return!0},Edit:"datetime"},v={datetime:function({data:e,field:n,onChange:t,hideLabelFromVision:l}){const{id:a,label:o}=n,s=n.getValue({item:e}),r=(0,m.useCallback)((e=>t({[a]:e})),[a,t]);return(0,i.jsxs)("fieldset",{className:"dataviews-controls__datetime",children:[!l&&(0,i.jsx)(p.BaseControl.VisualLabel,{as:"legend",children:o}),l&&(0,i.jsx)(p.VisuallyHidden,{as:"legend",children:o}),(0,i.jsx)(p.TimePicker,{currentTime:s,onChange:r,hideLabelFromVision:!0})]})},integer:function({data:e,field:n,onChange:t,hideLabelFromVision:l}){var a;const{id:o,label:s,description:r}=n,d=null!==(a=n.getValue({item:e}))&&void 0!==a?a:"",c=(0,m.useCallback)((e=>t({[o]:Number(e)})),[o,t]);return(0,i.jsx)(p.__experimentalNumberControl,{label:s,help:r,value:d,onChange:c,__next40pxDefaultSize:!0,hideLabelFromVision:l})},radio:function({data:e,field:n,onChange:t,hideLabelFromVision:l}){const{id:a,label:o}=n,s=n.getValue({item:e}),r=(0,m.useCallback)((e=>t({[a]:e})),[a,t]);return n.elements?(0,i.jsx)(p.RadioControl,{label:o,onChange:r,options:n.elements,selected:s,hideLabelFromVision:l}):null},select:function({data:n,field:t,onChange:l,hideLabelFromVision:a}){var o,s;const{id:r,label:d}=t,c=null!==(o=t.getValue({item:n}))&&void 0!==o?o:"",u=(0,m.useCallback)((e=>l({[r]:e})),[r,l]),f=[{label:(0,e.__)("Select item"),value:""},...null!==(s=t?.elements)&&void 0!==s?s:[]];return(0,i.jsx)(p.SelectControl,{label:d,value:c,options:f,onChange:u,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,hideLabelFromVision:a})},text:function({data:e,field:n,onChange:t,hideLabelFromVision:l}){const{id:a,label:o,placeholder:s}=n,r=n.getValue({item:e}),d=(0,m.useCallback)((e=>t({[a]:e})),[a,t]);return(0,i.jsx)(p.TextControl,{label:o,placeholder:s,value:null!=r?r:"",onChange:d,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,hideLabelFromVision:l})}};function b(e){if(Object.keys(v).includes(e))return v[e];throw"Control "+e+" not found"}function x(e){return e.map((e=>{var n,t,l,i;const a="integer"===(o=e.type)?f:"text"===o?g:"datetime"===o?h:{sort:(e,n,t)=>"number"==typeof e&&"number"==typeof n?"asc"===t?e-n:n-e:"asc"===t?e.localeCompare(n):n.localeCompare(e),isValid:(e,n)=>{if(n?.elements){const t=n?.elements?.map((e=>e.value));if(!t.includes(e))return!1}return!0},Edit:()=>null};var o;const s=e.getValue||(({item:n})=>n[e.id]),r=null!==(n=e.sort)&&void 0!==n?n:function(e,n,t){return a.sort(s({item:e}),s({item:n}),t)},d=null!==(t=e.isValid)&&void 0!==t?t:function(e,n){return a.isValid(s({item:e}),n)},c=function(e,n){return"function"==typeof e.Edit?e.Edit:"string"==typeof e.Edit?b(e.Edit):e.elements?b("select"):"string"==typeof n.Edit?b(n.Edit):n.Edit}(e,a),u=e.render||(e.elements?({item:n})=>{const t=s({item:n});return e?.elements?.find((e=>e.value===t))?.label||s({item:n})}:s);return{...e,label:e.label||e.id,header:e.header||e.label||e.id,getValue:s,render:u,sort:r,isValid:d,Edit:c,enableHiding:null===(l=e.enableHiding)||void 0===l||l,enableSorting:null===(i=e.enableSorting)||void 0===i||i}}))}const _=(0,i.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(l.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})});function w({title:n,onClose:t}){return(0,i.jsx)(p.__experimentalVStack,{className:"dataforms-layouts-panel__dropdown-header",spacing:4,children:(0,i.jsxs)(p.__experimentalHStack,{alignment:"center",children:[(0,i.jsx)(p.__experimentalHeading,{level:2,size:13,children:n}),(0,i.jsx)(p.__experimentalSpacer,{}),t&&(0,i.jsx)(p.Button,{__next40pxDefaultSize:!1,className:"dataforms-layouts-panel__dropdown-header-action",label:(0,e.__)("Close"),icon:_,onClick:t})]})})}function C({data:n,field:t,onChange:l}){const[a,o]=(0,m.useState)(null),s=(0,m.useMemo)((()=>({anchor:a,placement:"left-start",offset:36,shift:!0})),[a]);return(0,i.jsxs)(p.__experimentalHStack,{ref:o,className:"dataforms-layouts-panel__field",children:[(0,i.jsx)("div",{className:"dataforms-layouts-panel__field-label",children:t.label}),(0,i.jsx)("div",{children:(0,i.jsx)(p.Dropdown,{contentClassName:"dataforms-layouts-panel__field-dropdown",popoverProps:s,focusOnMount:!0,toggleProps:{size:"compact",variant:"tertiary",tooltipPosition:"middle left"},renderToggle:({isOpen:l,onToggle:a})=>(0,i.jsx)(p.Button,{className:"dataforms-layouts-panel__field-control",size:"compact",variant:"tertiary","aria-expanded":l,"aria-label":(0,e.sprintf)(
// translators: %s: Field name.
// translators: %s: Field name.
(0,e.__)("Edit %s"),t.label),onClick:a,children:(0,i.jsx)(t.render,{item:n})}),renderContent:({onClose:e})=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(w,{title:t.label,onClose:e}),(0,i.jsx)(t.Edit,{data:n,field:t,onChange:l,hideLabelFromVision:!0},t.id)]})})})]})}const j=[{type:"regular",component:function({data:e,fields:n,form:t,onChange:l}){const a=(0,m.useMemo)((()=>{var e;return x((null!==(e=t.fields)&&void 0!==e?e:[]).map((e=>n.find((({id:n})=>n===e)))).filter((e=>!!e)))}),[n,t.fields]);return(0,i.jsx)(p.__experimentalVStack,{spacing:4,children:a.map((n=>(0,i.jsx)(n.Edit,{data:e,field:n,onChange:l},n.id)))})}},{type:"panel",component:function({data:e,fields:n,form:t,onChange:l}){const a=(0,m.useMemo)((()=>{var e;return x((null!==(e=t.fields)&&void 0!==e?e:[]).map((e=>n.find((({id:n})=>n===e)))).filter((e=>!!e)))}),[n,t.fields]);return(0,i.jsx)(p.__experimentalVStack,{spacing:2,children:a.map((n=>(0,i.jsx)(C,{data:e,field:n,onChange:l},n.id)))})}}];function V({form:e,...n}){var t;const l=(a=null!==(t=e.type)&&void 0!==t?t:"regular",j.find((e=>e.type===a)));var a;return l?(0,i.jsx)(l.component,{form:e,...n}):null}const y=[{label:"Latest",value:"latest"},{label:"8.3",value:"8.3"},{label:"8.2",value:"8.2"},{label:"8.1",value:"8.1"},{label:"8.0",value:"8.0"},{label:"7.4",value:"7.4"},{label:"7.3",value:"7.3"},{label:"7.2",value:"7.2"},{label:"7.1",value:"7.1"},{label:"7.0",value:"7.0"}],S=[{label:"Wordpress nightly",value:"nightly"},{label:"6.6",value:"6.1"},{label:"6.5",value:"6.1"},{label:"6.4",value:"6.2"},{label:"6.3",value:"6.1"}];(0,n.registerPlugin)("blueprint-version-control",{render:function(){const{createNotice:n}=(0,r.useDispatch)(d.store),{editPost:l}=(0,r.useDispatch)("core/editor"),m=(0,r.useSelect)((e=>e("core/block-editor").getBlocks()),[]),f=(0,r.useSelect)((e=>e("core/editor").getEditedPostAttribute("meta")._blueprint_config||{})),g={$schema:"https://playground.wordpress.net/blueprint-schema.json",landingPage:f.landing_page,preferredVersions:{php:f.php_version,wp:f.wp_version},steps:[]},h=()=>{const e=m.map((e=>e.attributes));return g.steps=[...e],JSON.stringify(g,null,2)},v=(0,c.useCopyToClipboard)(h,(()=>{n("success",(0,e.__)("Blueprint Schema Copied!"),{type:"snackbar"})}));return(0,i.jsxs)(t.PluginDocumentSettingPanel,{name:"playground-settings",title:"Playground Settings",children:[(0,i.jsxs)(p.__experimentalHStack,{justify:"left",children:[(0,i.jsx)(p.Button,{variant:"secondary",icon:a,href:"https://playground.wordpress.net/#"+h(),target:"_new"}),(0,i.jsx)(p.Button,{variant:"secondary",ref:v,icon:o}),(0,i.jsx)(p.Button,{variant:"secondary",icon:s,onClick:()=>{const t=h();t&&((0,u.downloadBlob)("playground-blueprint.json",t,"application/json"),n("success",(0,e.__)("Blueprint downloaded successfully!")))}})]}),(0,i.jsx)(V,{data:{php_version:f.php_version,wp_version:f.wp_version,landing_page:f.landing_page},fields:[{elements:y,id:"php_version",label:"PHP Version",type:"text"},{elements:S,id:"wp_version",label:"WP Version",type:"text"},{id:"landing_page",label:"Landing Page",type:"text"}],form:{fields:["php_version","wp_version","landing_page"]},onChange:e=>{l({meta:{_blueprint_config:{...f,...e}}})}})]})}})})();