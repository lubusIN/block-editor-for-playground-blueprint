(()=>{"use strict";const e=window.ReactJSXRuntime,{ButtonBlockAppender:n}=wp.blockEditor,{useSelect:t}=wp.data;wp.hooks.addFilter("editor.BlockEdit","block-editor-for-playground-blueprint/default-block-appender",(l=>i=>{const a=t((e=>{const n=e("core/block-editor").getBlockOrder();return n[n.length-1]}),[]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l,{...i}),i.clientId===a&&(0,e.jsx)("div",{className:"block-list-appender wp-block",children:(0,e.jsx)(n,{rootClientId:null})})]})}));const l=window.wp.i18n,i=window.wp.plugins,a=window.wp.editor,o=window.wp.primitives,s=(0,e.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(o.Path,{d:"M12 3.3c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8s-4-8.8-8.8-8.8zm6.5 5.5h-2.6C15.4 7.3 14.8 6 14 5c2 .6 3.6 2 4.5 3.8zm.7 3.2c0 .6-.1 1.2-.2 1.8h-2.9c.1-.6.1-1.2.1-1.8s-.1-1.2-.1-1.8H19c.2.6.2 1.2.2 1.8zM12 18.7c-1-.7-1.8-1.9-2.3-3.5h4.6c-.5 1.6-1.3 2.9-2.3 3.5zm-2.6-4.9c-.1-.6-.1-1.1-.1-1.8 0-.6.1-1.2.1-1.8h5.2c.1.6.1 1.1.1 1.8s-.1 1.2-.1 1.8H9.4zM4.8 12c0-.6.1-1.2.2-1.8h2.9c-.1.6-.1 1.2-.1 1.8 0 .6.1 1.2.1 1.8H5c-.2-.6-.2-1.2-.2-1.8zM12 5.3c1 .7 1.8 1.9 2.3 3.5H9.7c.5-1.6 1.3-2.9 2.3-3.5zM10 5c-.8 1-1.4 2.3-1.8 3.8H5.5C6.4 7 8 5.6 10 5zM5.5 15.3h2.6c.4 1.5 1 2.8 1.8 3.7-1.8-.6-3.5-2-4.4-3.7zM14 19c.8-1 1.4-2.2 1.8-3.7h2.6C17.6 17 16 18.4 14 19z"})}),r=(0,e.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(o.Path,{d:"M18 11.3l-1-1.1-4 4V3h-1.5v11.3L7 10.2l-1 1.1 6.2 5.8 5.8-5.8zm.5 3.7v3.5h-13V15H4v5h16v-5h-1.5z"})}),d=(0,e.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(o.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M5 4.5h11a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-.5.5H5a.5.5 0 0 1-.5-.5V5a.5.5 0 0 1 .5-.5ZM3 5a2 2 0 0 1 2-2h11a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5Zm17 3v10.75c0 .69-.56 1.25-1.25 1.25H6v1.5h12.75a2.75 2.75 0 0 0 2.75-2.75V8H20Z"})}),c=(0,e.jsx)(o.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,e.jsx)(o.Path,{d:"M20.8 10.7l-4.3-4.3-1.1 1.1 4.3 4.3c.1.1.1.3 0 .4l-4.3 4.3 1.1 1.1 4.3-4.3c.7-.8.7-1.9 0-2.6zM4.2 11.8l4.3-4.3-1-1-4.3 4.3c-.7.7-.7 1.8 0 2.5l4.3 4.3 1.1-1.1-4.3-4.3c-.2-.1-.2-.3-.1-.4z"})}),u=window.wp.data,p=window.wp.notices,m=window.wp.compose,g=window.wp.blob,h=window.wp.components,b=window.wp.element,f={sort:function(e,n,t){return"asc"===t?e-n:n-e},isValid:function(e,n){if(""===e)return!1;if(!Number.isInteger(Number(e)))return!1;if(n?.elements){const t=n?.elements.map((e=>e.value));if(!t.includes(Number(e)))return!1}return!0},Edit:"integer"},x={sort:function(e,n,t){return"asc"===t?e.localeCompare(n):n.localeCompare(e)},isValid:function(e,n){if(n?.elements){const t=n?.elements?.map((e=>e.value));if(!t.includes(e))return!1}return!0},Edit:"text"},w={sort:function(e,n,t){const l=new Date(e).getTime(),i=new Date(n).getTime();return"asc"===t?l-i:i-l},isValid:function(e,n){if(n?.elements){const t=n?.elements.map((e=>e.value));if(!t.includes(e))return!1}return!0},Edit:"datetime"},v={datetime:function({data:n,field:t,onChange:l,hideLabelFromVision:i}){const{id:a,label:o}=t,s=t.getValue({item:n}),r=(0,b.useCallback)((e=>l({[a]:e})),[a,l]);return(0,e.jsxs)("fieldset",{className:"dataviews-controls__datetime",children:[!i&&(0,e.jsx)(h.BaseControl.VisualLabel,{as:"legend",children:o}),i&&(0,e.jsx)(h.VisuallyHidden,{as:"legend",children:o}),(0,e.jsx)(h.TimePicker,{currentTime:s,onChange:r,hideLabelFromVision:!0})]})},integer:function({data:n,field:t,onChange:l,hideLabelFromVision:i}){var a;const{id:o,label:s,description:r}=t,d=null!==(a=t.getValue({item:n}))&&void 0!==a?a:"",c=(0,b.useCallback)((e=>l({[o]:Number(e)})),[o,l]);return(0,e.jsx)(h.__experimentalNumberControl,{label:s,help:r,value:d,onChange:c,__next40pxDefaultSize:!0,hideLabelFromVision:i})},radio:function({data:n,field:t,onChange:l,hideLabelFromVision:i}){const{id:a,label:o}=t,s=t.getValue({item:n}),r=(0,b.useCallback)((e=>l({[a]:e})),[a,l]);return t.elements?(0,e.jsx)(h.RadioControl,{label:o,onChange:r,options:t.elements,selected:s,hideLabelFromVision:i}):null},select:function({data:n,field:t,onChange:i,hideLabelFromVision:a}){var o,s;const{id:r,label:d}=t,c=null!==(o=t.getValue({item:n}))&&void 0!==o?o:"",u=(0,b.useCallback)((e=>i({[r]:e})),[r,i]),p=[{label:(0,l.__)("Select item"),value:""},...null!==(s=t?.elements)&&void 0!==s?s:[]];return(0,e.jsx)(h.SelectControl,{label:d,value:c,options:p,onChange:u,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,hideLabelFromVision:a})},text:function({data:n,field:t,onChange:l,hideLabelFromVision:i}){const{id:a,label:o,placeholder:s}=t,r=t.getValue({item:n}),d=(0,b.useCallback)((e=>l({[a]:e})),[a,l]);return(0,e.jsx)(h.TextControl,{label:o,placeholder:s,value:null!=r?r:"",onChange:d,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,hideLabelFromVision:i})}};function _(e){if(Object.keys(v).includes(e))return v[e];throw"Control "+e+" not found"}function j(e){return e.map((e=>{var n,t,l,i;const a="integer"===(o=e.type)?f:"text"===o?x:"datetime"===o?w:{sort:(e,n,t)=>"number"==typeof e&&"number"==typeof n?"asc"===t?e-n:n-e:"asc"===t?e.localeCompare(n):n.localeCompare(e),isValid:(e,n)=>{if(n?.elements){const t=n?.elements?.map((e=>e.value));if(!t.includes(e))return!1}return!0},Edit:()=>null};var o;const s=e.getValue||(({item:n})=>n[e.id]),r=null!==(n=e.sort)&&void 0!==n?n:function(e,n,t){return a.sort(s({item:e}),s({item:n}),t)},d=null!==(t=e.isValid)&&void 0!==t?t:function(e,n){return a.isValid(s({item:e}),n)},c=function(e,n){return"function"==typeof e.Edit?e.Edit:"string"==typeof e.Edit?_(e.Edit):e.elements?_("select"):"string"==typeof n.Edit?_(n.Edit):n.Edit}(e,a),u=e.render||(e.elements?({item:n})=>{const t=s({item:n});return e?.elements?.find((e=>e.value===t))?.label||s({item:n})}:s);return{...e,label:e.label||e.id,header:e.header||e.label||e.id,getValue:s,render:u,sort:r,isValid:d,Edit:c,enableHiding:null===(l=e.enableHiding)||void 0===l||l,enableSorting:null===(i=e.enableSorting)||void 0===i||i}}))}const C=(0,e.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(o.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})});function V({title:n,onClose:t}){return(0,e.jsx)(h.__experimentalVStack,{className:"dataforms-layouts-panel__dropdown-header",spacing:4,children:(0,e.jsxs)(h.__experimentalHStack,{alignment:"center",children:[(0,e.jsx)(h.__experimentalHeading,{level:2,size:13,children:n}),(0,e.jsx)(h.__experimentalSpacer,{}),t&&(0,e.jsx)(h.Button,{__next40pxDefaultSize:!1,className:"dataforms-layouts-panel__dropdown-header-action",label:(0,l.__)("Close"),icon:C,onClick:t})]})})}function k({data:n,field:t,onChange:i}){const[a,o]=(0,b.useState)(null),s=(0,b.useMemo)((()=>({anchor:a,placement:"left-start",offset:36,shift:!0})),[a]);return(0,e.jsxs)(h.__experimentalHStack,{ref:o,className:"dataforms-layouts-panel__field",children:[(0,e.jsx)("div",{className:"dataforms-layouts-panel__field-label",children:t.label}),(0,e.jsx)("div",{children:(0,e.jsx)(h.Dropdown,{contentClassName:"dataforms-layouts-panel__field-dropdown",popoverProps:s,focusOnMount:!0,toggleProps:{size:"compact",variant:"tertiary",tooltipPosition:"middle left"},renderToggle:({isOpen:i,onToggle:a})=>(0,e.jsx)(h.Button,{className:"dataforms-layouts-panel__field-control",size:"compact",variant:"tertiary","aria-expanded":i,"aria-label":(0,l.sprintf)(
// translators: %s: Field name.
// translators: %s: Field name.
(0,l.__)("Edit %s"),t.label),onClick:a,children:(0,e.jsx)(t.render,{item:n})}),renderContent:({onClose:l})=>(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(V,{title:t.label,onClose:l}),(0,e.jsx)(t.Edit,{data:n,field:t,onChange:i,hideLabelFromVision:!0},t.id)]})})})]})}const y=[{type:"regular",component:function({data:n,fields:t,form:l,onChange:i}){const a=(0,b.useMemo)((()=>{var e;return j((null!==(e=l.fields)&&void 0!==e?e:[]).map((e=>t.find((({id:n})=>n===e)))).filter((e=>!!e)))}),[t,l.fields]);return(0,e.jsx)(h.__experimentalVStack,{spacing:4,children:a.map((t=>(0,e.jsx)(t.Edit,{data:n,field:t,onChange:i},t.id)))})}},{type:"panel",component:function({data:n,fields:t,form:l,onChange:i}){const a=(0,b.useMemo)((()=>{var e;return j((null!==(e=l.fields)&&void 0!==e?e:[]).map((e=>t.find((({id:n})=>n===e)))).filter((e=>!!e)))}),[t,l.fields]);return(0,e.jsx)(h.__experimentalVStack,{spacing:2,children:a.map((t=>(0,e.jsx)(k,{data:n,field:t,onChange:i},t.id)))})}}];function S({form:n,...t}){var l;const i=(a=null!==(l=n.type)&&void 0!==l?l:"regular",y.find((e=>e.type===a)));var a;return i?(0,e.jsx)(i.component,{form:n,...t}):null}const B=[{label:"Latest",value:"latest"},{label:"8.3",value:"8.3"},{label:"8.2",value:"8.2"},{label:"8.1",value:"8.1"},{label:"8.0",value:"8.0"},{label:"7.4",value:"7.4"},{label:"7.3",value:"7.3"},{label:"7.2",value:"7.2"},{label:"7.1",value:"7.1"},{label:"7.0",value:"7.0"}],P=[{label:"Wordpress nightly",value:"nightly"},{label:"6.6",value:"6.1"},{label:"6.5",value:"6.1"},{label:"6.4",value:"6.2"},{label:"6.3",value:"6.1"}];(0,i.registerPlugin)("blueprint-version-control",{render:function(){const{createNotice:n}=(0,u.useDispatch)(p.store),{editPost:t}=(0,u.useDispatch)("core/editor"),i=(0,u.useSelect)((e=>e("core/block-editor").getBlocks()),[]),o=(0,u.useSelect)((e=>e("core/editor").getEditedPostAttribute("meta")._blueprint_config||{})),b={$schema:"https://playground.wordpress.net/blueprint-schema.json",landingPage:o.landing_page,preferredVersions:{php:o.php_version,wp:o.wp_version},phpExtensionBundles:[o.php_extension_bundles],features:{networking:o.networking},steps:[]},f=()=>{const e=i.map((e=>(delete e.attributes.metadata,e.attributes)));return b.steps=[...e],JSON.stringify(b,null,2)},x=(0,m.useCopyToClipboard)(f,(()=>{n("success",(0,l.__)("Blueprint Schema Copied!"),{type:"snackbar"})}));return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(a.PluginPostStatusInfo,{children:(0,e.jsxs)(h.Toolbar,{children:[(0,e.jsx)(h.ToolbarButton,{icon:s,label:"Open in playground",href:"https://playground.wordpress.net/#"+f(),target:"_blank"}),(0,e.jsx)(h.ToolbarButton,{icon:r,label:"Download JSON",onClick:()=>{const e=f();e&&((0,g.downloadBlob)("playground-blueprint.json",e,"application/json"),n("success",(0,l.__)("Blueprint downloaded generated!"),{type:"snackbar"}))}}),(0,e.jsx)(h.ToolbarButton,{icon:d,label:"Copy JSON",ref:x}),(0,e.jsx)(h.ToolbarButton,{icon:c,label:"Open in Builder",href:"https://playground.wordpress.net/builder/builder.html#"+f(),target:"_blank"})]})}),(0,e.jsx)(a.PluginDocumentSettingPanel,{name:"playground-settings",title:"Playground Settings",children:(0,e.jsx)(S,{data:{php_version:o.php_version,wp_version:o.wp_version,landing_page:o.landing_page,php_extension_bundles:o.php_extension_bundles,networking:o.networking},fields:[{elements:B,id:"php_version",label:"PHP Version",type:"text"},{elements:P,id:"wp_version",label:"WP Version",type:"text"},{id:"landing_page",label:"Landing Page",type:"text"},{id:"php_extension_bundles",label:"PHP Extension Bundles",type:"text",elements:[{label:"Kitchen Sink",value:"kitchen-sink"},{label:"Light",value:"light"}]},{id:"networking",label:"Networking",type:"text",elements:[{label:"Enabled",value:!0},{label:"Disabled",value:!1}]}],form:{fields:["php_version","wp_version","landing_page","php_extension_bundles","networking"]},onChange:e=>{t({meta:{_blueprint_config:{...o,...e}}})}})})]})}})})();